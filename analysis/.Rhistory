cat("Hello")
R.home()
?R.home()
R.home("bin")
library(kable)
install.packages('kable')
library(kableExtra)
bs_id <- read_csv("progenetix/progenetix_tcga_individuals_biosamples_combined_data.csv")
setwd("/Users/kayvongrunigen/Projects/maf4pgx/data")
library(tidyverse)
library(ggplot2)
library(ggmap)
library(ggpubr)
library(ggfortify)
library(GGally)
library(lubridate)
library(scales)
library(svglite)
library(tableone)
library(survival)
library(gt)
library(kableExtra)
# Themes for graphs
mytheme <-   theme_classic() +
theme(plot.title = element_text(hjust = 0.5, size = 16),
plot.subtitle = element_text(hjust = 0.5, face = "italic", size = 14),
axis.text.x = element_text(angle = 45, hjust = 1, size = 12),
axis.text.y = element_text(size = 12),
axis.title = element_text(size = 14))
poster_theme <-   theme_classic() +
theme(plot.title = element_text(hjust = 0.5, size = 28),
plot.subtitle = element_text(hjust = 0.5, face = "italic", size = 26),
axis.text.x = element_text(size = 20),
axis.text.y = element_text(size = 20),
axis.title = element_text(size = 26))
bs_id <- read_csv("progenetix/progenetix_tcga_individuals_biosamples_combined_data.csv")
# Individuals ------------------------------------------------------------------
individuals <- read_csv("progenetix/progenetix_tcga_individuals_data.csv")
# Variables:
dput(names(individuals))
# updated
# individual_id
# days_to_death
# birthyear
# vital_status
# sex
# external_references
# disease
# stage
# survival_time_days
# ethnicity
# age_at_diagnosis
# followup_time_months
# Converting strings to factors
individuals$vital_status <- as.factor(individuals$vital_status)
individuals$sex <- as.factor(individuals$sex)
individuals$ethnicity <- as.factor(individuals$ethnicity)
## Stage from biosamples is more detailed
individuals$stage <- as.factor(individuals$stage)
summary(individuals)
individuals$external_references[1]
## Table 1 ---------------------------------------------------------------------
table1 <- individuals %>%
select(c(sex, birthyear, age_at_diagnosis, stage,
ethnicity, vital_status,
days_to_death, followup_time_months))
table1 <- CreateTableOne(data = table1)
## Why is days_to_death different from survival_time_days?
## survival_time_days is derived from days_to_death -> take days_to_death
ptable1 <- print(table1, printToggle = FALSE, noSpaces = TRUE)
kable(ptable1, format = "latex")
# Biosamples -------------------------------------------------------------------
biosamples <- read_csv("progenetix/progenetix_tcga_biosamples_data.csv")
# Variables:
dput(names(biosamples))
# "individual_id"
# "substage"
# "callset_ids"
# "biosample_id"
# "histological_diagnosis"
# "icdo_morphology"
# "icdo_topography"
# "tumor_type"
# "sample_origin"
# "collection_moment_years"
# "project"
# "stage"
# Converting strings to factors
biosamples$substage <- as.factor(biosamples$substage)
biosamples$stage <- as.factor(biosamples$stage)
biosamples$histological_diagnosis <- as.factor(biosamples$histological_diagnosis) # nolint: line_length_linter.
biosamples$icdo_morphology <- as.factor(biosamples$icdo_morphology)
biosamples$icdo_topography <- as.factor(biosamples$icdo_topography)
biosamples$sample_origin <- as.factor(biosamples$sample_origin)
biosamples$tumor_type <- as.factor(biosamples$tumor_type)
biosamples$project <- as.factor(biosamples$project)
summary(biosamples)
## Table 2 ---------------------------------------------------------------------
table2 <- biosamples %>%
select(c(substage, histological_diagnosis, icdo_morphology,
icdo_topography, sample_origin, tumor_type, collection_moment_years))
## sample_origin, icdo_topography, icdo_morphology,
## histologicals_diagnosis too long
table2 <- biosamples %>%
select(c(substage, tumor_type, collection_moment_years, project))
CreateTableOne(data = table2)
# Biosamples + Individuals -----------------------------------------------------
individuals <- individuals %>%
select(-c(stage))
meta_data <- merge(biosamples, individuals, by = "individual_id")
meta_data))]
# Sort columns in alphabetical order
meta_data <- meta_data[, order(names(meta_data))]
bs_id <- bs_id[, order(names(bs_id))]
# Convert multiple columns to factors
meta_data <- meta_data %>%
mutate_at(vars(stage, substage, histological_diagnosis, icdo_morphology,
icdo_topography, sample_origin, tumor_type, project,
vital_status, sex, ethnicity),
as.factor)
# Load data
meta_data <- read_csv("progenetix/progenetix_tcga_individuals_biosamples_combined_data.csv")
# Sort columns in alphabetical order
meta_data <- meta_data[, order(names(meta_data))]
# Converting strings to factors
biosamples$substage <- as.factor(biosamples$substage)
biosamples$stage <- as.factor(biosamples$stage)
biosamples$histological_diagnosis <- as.factor(biosamples$histological_diagnosis) # nolint: line_length_linter.
biosamples$icdo_morphology <- as.factor(biosamples$icdo_morphology)
# Convert multiple columns to factors
meta_data <- meta_data %>%
mutate_at(vars(stage, substage, histological_diagnosis, icdo_morphology,
icdo_topography, sample_origin, tumor_type, project,
vital_status, sex, ethnicity),
as.factor)
# Variables:
dput(names(biosamples))
# Sort columns in alphabetical order
meta_data <- meta_data[, order(names(meta_data))]
# Variables:
dput(names(biosamples))
# Variables:
order(dput(names(biosamples)))
variables[, order(variables)]
# Variables:
variables <- dput(names(biosamples))
variables[, order(variables)]
variables[, order(names(variables)]
variables[, order(names(variables))]
# Variables:
variables <- dput(names(biosamples))
variables[, order(names(variables))]
# Show alphabetically ordered columns
dput(names(meta_data))
# Variables:
dput(names(meta_data))
metadata <- read_csv("progenetix/progenetix_tcga_individuals_biosamples_combined_data.csv")
# Sort columns in alphabetical order
metadata <- metadata[, order(names(metadata))]
# Convert multiple columns to factors
metadata <- metadata %>%
mutate_at(vars(stage, substage, histological_diagnosis, icdo_morphology,
icdo_topography, sample_origin, tumor_type, project,
vital_status, sex, ethnicity),
as.factor)
# Variables:
dput(names(metadata))
# age_at_diagnosis
# biosample_id
# birth_year
# callset_ids
# collection_moment_years
# days_to_death
# disease
# ethnicity
# followup_time_months
# histological_diagnosis
# icdo_morphology
# icdo_topography
# individual_id
# project
# sample_origin
# sex
# stage
# substage
# tumor_type
# updated
# vital_status
summary(metadata)
View(meta_data)
rm(meta_data)
rm(c(biosamples, individuals, bs_id))
rm(biosamples, individuals, bs_id)
## Table 1 ---------------------------------------------------------------------
table1 <- metadata %>%
select(c(sex, birthyear, age_at_diagnosis, stage,
ethnicity, vital_status,
days_to_death, followup_time_months))
## Table 1 ---------------------------------------------------------------------
table1 <- metadata %>%
select(c(sex, birth_year, age_at_diagnosis, stage,
ethnicity, vital_status,
days_to_death, followup_time_months))
table1 <- CreateTableOne(data = table1)
ptable1 <- print(table1, printToggle = FALSE, noSpaces = TRUE)
kable(ptable1, format = "latex")
## Table 2 ---------------------------------------------------------------------
table2 <- metadata %>%
select(c(substage, histological_diagnosis, icdo_morphology,
icdo_topography, sample_origin, tumor_type, collection_moment_years))
table2 <- biosamples %>%
select(c(substage, tumor_type, collection_moment_years, project))
table2 <- metadata %>%
select(c(substage, tumor_type, collection_moment_years, project))
CreateTableOne(data = table2)
